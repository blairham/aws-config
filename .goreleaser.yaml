# GoReleaser configuration
version: 2

# Project metadata
project_name: aws-config

before:
  hooks:
  - go mod tidy
  - go generate ./...

builds:
- id: "aws-config"
  main: .
  binary: aws-config
  env:
  - CGO_ENABLED=0
  goos:
  - linux
  - darwin
  - windows
  goarch:
  - amd64
  - arm64
  # Build flags
  ldflags:
  - -s -w
  - -X main.version={{.Version}}
  - -X main.commit={{.Commit}}
  - -X main.buildTime={{.Date}}
  # Build constraints
  ignore:
  - goos: windows
    goarch: arm64

archives:
- id: "archives"
  name_template: "{{ .ProjectName }}_{{ .Version }}_{{ .Os }}_{{ .Arch }}"
  files:
  - README.md
  - LICENSE*

checksum:
  name_template: "checksums.txt"
  algorithm: sha256

changelog:
  sort: asc
  use: github
  filters:
    exclude:
    - "^docs:"
    - "^test:"
    - "^ci:"
    - "^build:"
    - "merge conflict"
    - Merge pull request
    - Merge remote-tracking branch
    - Merge branch
  groups:
  - title: "New Features"
    regexp: "^.*feat[(\\w)]*:+.*$"
    order: 0
  - title: "Bug Fixes"
    regexp: "^.*fix[(\\w)]*:+.*$"
    order: 1
  - title: "Documentation"
    regexp: "^.*docs[(\\w)]*:+.*$"
    order: 2
  - title: "Other Changes"
    order: 999

release:
  github:
    owner: blairham
    name: aws-config
  name_template: "{{.ProjectName}} v{{.Version}}"
  draft: false
  prerelease: auto

# Homebrew formula (optional - uncomment and configure if desired)
# brews:
#   - repository:
#       owner: blairham
#       name: homebrew-tap
#     directory: Formula
#     homepage: "https://github.com/blairham/aws-config"
#     description: "AWS configuration management tool"
#     license: "MIT"
#     test: |
#       system "#{bin}/aws-config --help"
#     dependencies:
#       - name: git
#     install: |
#       bin.install "aws-config"

# Docker images (optional - uncomment and configure if desired)
# dockers:
#   - image_templates:
#       - "ghcr.io/blairham/aws-config:{{ .Version }}"
#       - "ghcr.io/blairham/aws-config:latest"
#     dockerfile: Dockerfile
#     build_contexts:
#       app: "."
#     extra_files:
#       - "README.md"
